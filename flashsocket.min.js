(function(n){"use strict";function t(n,r){var f=this||new t(n,r);return(r===undefined?r=[]:Object.prototype.toString.call(r)!=="[object Array]"&&(r=[r]),!t.forceFlash&&s)?new s(n,r):(f._id=i.push(f)-1,f._events={open:[function(n){u(f.onopen)&&f.onopen(n)}],error:[function(n){u(f.onerror)&&f.onerror(n)}],close:[function(n){u(f.onclose)&&f.onclose(n)}],message:[function(n){u(f.onmessage)&&f.onmessage(n)}]},f.url=n,f.extensions="",f.protocol="",f.readyState=c,f.bufferedAmount=0,f.binaryType="blob",f.onopen=null,f.onerror=null,f.onclose=null,f.onmessage=null,o("connect",[f._id,n,r]),f)}var d="__FLASHSOCKET__",h="9.0.0",c=0,b=1,k=2,v=3,s=n.WebSocket||n.MozWebSocket,i=[],f=[],e=null,l=!1,a=!1,w=function(){l||(l=!0,swfobject.addDomLoadEvent(function(){var n=document.createElement("div");n.id=d+"LOADER",document.body.appendChild(n),swfobject.embedSWF(t.swfUrl,n.id,"1","1",h,null,null,{allowScriptAccess:"always",wmode:"transparent"},{style:"position:absolute;top:0px;left:0px;"},function(n){if(n.success)e=n.ref;else throw new Error("FlashSocket is not supported");})}))},u=function(n){return n instanceof Function},r=function(n){return function(){var i=this,t=arguments;setTimeout(function(){n.apply(i,t)},1)}},o=function(n,t,i){p(function(){var r;try{r=e[n].apply(e,t)}catch(u){throw new Error(e.getLastException());}i&&i(r)})},y=function(){swfobject.hasFlashPlayerVersion(h)||!!s},p=function(n){a?n():(w(),f.push(n))};t.CONNECTING=c,t.OPEN=b,t.CLOSING=k,t.CLOSED=v,t.prototype={close:function(n,t){o("close",[this._id,n===undefined?-1:n,t===undefined?"":t])},send:function(n){if(!arguments.length)throw new SyntaxError("Not enough arguments");var t=this;o("send",[t._id,""+n],function(n){t.bufferedAmount=n})},addEventlistener:function(n,t){var r,i,f;if(u(t)){for(r=this._events[n]=this._events[n]||[],i=0,f=r.length;i<f;i++)if(r[i]===t)return;r.push(t)}},removeEventlistener:function(n,t){var r=this._events[n],i,u;if(r)for(i=0,u=r.length;i<u;i++)if(r[i]===t){r.splice(i,1);break}},dispatchEvent:function(n){var i=this._events[n.type],t,r;if(i)for(t=0,r=i.length;t<r;t++)i[t].call(this,n);return!0}},t.ExternalInterface={onready:r(function(){a=!0;for(var n=0,t=f.length;n<t;n++)f[n]();f=null}),onopen:r(function(n,t,r,u){var f=i[n];f&&(f.url=t,f.extensions=r,f.protocols=u,f.dispatchEvent({type:"open",target:f}))}),onerror:r(function(n){var t=i[n];t&&t.dispatchEvent({type:"error",target:t})}),onclose:r(function(n,t,r,u){var f=i[n];f&&f.dispatchEvent({type:"close",target:f,code:t,reason:r,wasClean:u})}),onmessage:r(function(n,t){var r=i[n];r&&r.dispatchEvent({type:"message",target:r,data:t})}),onexception:r(function(n,t,i){throw new Error(i);}),onreadystatechange:function(n,t){var r=i[n];r&&(r.readyState=t)},onbufferempty:function(n){var t=i[n];t&&(t.bufferedAmount=0)}},t.supported=y,t.forceFlash=!1,t.swfUrl="flashsocket.swf",n.FlashSocket=t})(window)